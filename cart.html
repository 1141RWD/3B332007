<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>è³¼ç‰©è»Š - æ™¨å…‰æ—©é¤åº—</title>
  
  <!-- æ¨£å¼è¡¨ -->
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="css/cart.css">
  
  <!-- JavaScript æª”æ¡ˆ -->
  <script src="js/data.js"></script>
  <script src="js/utils.js"></script>
  <script src="js/coupon-system.js"></script>
  <script src="js/auth.js"></script>
  <script src="js/shop.js"></script>
</head>
<body class="cart-page">
  <!-- å°è¦½åˆ—ï¼ˆèˆ‡ index.html ä¸€è‡´ï¼‰-->
  <nav class="navbar">
    <div class="navbar-container">
      <a href="index.html" class="navbar-brand">
        <span class="brand-icon">â˜€ï¸</span>
        <span class="brand-text">æ™¨å…‰æ—©é¤åº—</span>
      </a>
      
      <ul class="navbar-menu">
        <li><a href="index.html">é¦–é </a></li>
        <li><a href="menu.html">ç·šä¸Šé»é¤</a></li>
        <li><a href="stores.html">é–€å¸‚æŸ¥è©¢</a></li>
        <li><a href="contact.html">è¯çµ¡æˆ‘å€‘</a></li>
        
        <!-- è³¼ç‰©è»ŠæŒ‰éˆ•ï¼ˆç”¨æˆ¶é¸å–®å·¦é‚Šï¼‰-->
        <li>
          <a href="cart.html" class="navbar-cart active">
            ğŸ›’ è³¼ç‰©è»Š
            <span id="cartBadge" class="cart-badge" style="display: none;">0</span>
          </a>
        </li>
        
        <!-- ç”¨æˆ¶é¸å–®ï¼ˆæœ€å³é‚Šï¼‰-->
        <li class="navbar-user">
          <a href="login.html" id="navbarUserLink">ğŸ” ç™»å…¥ / è¨»å†Š</a>
        </li>
      </ul>
    </div>
  </nav>

  <!-- è³¼ç‰©è»Šä¸»è¦å…§å®¹ -->
  <div class="cart-container">
    <!-- è³¼ç‰©è»Šæ¨™é¡Œ -->
    <div class="cart-header">
      <h1>ğŸ›’ æˆ‘çš„è³¼ç‰©è»Š</h1>
      <p>æª¢æŸ¥æ‚¨çš„ç¾å‘³é¸æ“‡</p>
    </div>

    <!-- è³¼ç‰©è»Šå…§å®¹ -->
    <div class="cart-content">
      <!-- å·¦å´ï¼šå•†å“åˆ—è¡¨ -->
      <div class="cart-items-section">
        <div class="cart-items-header">
          <span id="cartItemsCount">æ‚¨çš„é¤é»</span>
        </div>

        <!-- ç©ºè³¼ç‰©è»Šç‹€æ…‹ -->
        <div id="emptyCart" class="empty-cart" style="display: none;">
          <div class="empty-cart-icon">ğŸ›’</div>
          <h2>è³¼ç‰©è»Šé‚„ç©ºç©ºçš„å–”~</h2>
          <p>å¿«å»æŒ‘é¸ç¾å‘³çš„æ—©é¤ï¼Œé–‹å•Ÿç¾å¥½çš„ä¸€å¤©ï¼</p>
          <a href="menu.html" class="go-shopping-btn">ğŸ³ å‰å¾€é»é¤</a>
        </div>

        <!-- è³¼ç‰©è»Šå•†å“åˆ—è¡¨ï¼ˆä¿ç•™æ­¤ IDï¼‰-->
        <div id="cartItems"></div>
      </div>

      <!-- å³å´ï¼šçµå¸³æ‘˜è¦ï¼ˆæ¡Œé¢ç‰ˆï¼‰-->
      <div id="cartSummary" class="cart-summary" style="display: none;">
        <h2 class="summary-title">ğŸ’° è¨‚å–®æ‘˜è¦</h2>

        <!-- æŠ˜åƒ¹åˆ¸é¸æ“‡ï¼ˆä¿ç•™æ­¤å€å¡Šï¼‰-->
        <div class="coupon-section">
          <label for="couponSelect" class="coupon-label">ğŸ« ä½¿ç”¨æŠ˜åƒ¹åˆ¸</label>
          <select id="couponSelect" class="coupon-select" onchange="window.calculateTotal()">
            <option value="">è¼‰å…¥ä¸­...</option>
          </select>
        </div>

        <!-- æŠ˜æ‰£è³‡è¨Šï¼ˆä½¿ç”¨æŠ˜åƒ¹åˆ¸æ™‚é¡¯ç¤ºï¼‰-->
        <div id="discountInfo" class="discount-info" style="display: none;">
          <div class="discount-row">
            <span>åŸåƒ¹</span>
            <span id="originalPrice">$0</span>
          </div>
          <div class="discount-row total">
            <span>ğŸ’° æŠ˜æ‰£å„ªæƒ </span>
            <span id="discountAmount">-$0</span>
          </div>
        </div>

        <!-- ä»˜æ¬¾æ–¹å¼é¸æ“‡ï¼ˆä¿ç•™æ­¤å€å¡Šï¼‰-->
        <div class="payment-section">
          <label class="payment-label">ğŸ’³ ä»˜æ¬¾æ–¹å¼</label>
          <div class="payment-methods">
            <label class="payment-option">
              <input type="radio" name="paymentMethod" value="cash" checked>
              <span class="payment-icon">ğŸ’µ</span>
              <span class="payment-text">ç¾é‡‘ä»˜æ¬¾</span>
            </label>
            <label class="payment-option">
              <input type="radio" name="paymentMethod" value="linepay">
              <span class="payment-icon">ğŸ’š</span>
              <span class="payment-text">Line Pay</span>
            </label>
            <label class="payment-option">
              <input type="radio" name="paymentMethod" value="applepay">
              <span class="payment-icon">ğŸ</span>
              <span class="payment-text">Apple Pay</span>
            </label>
          </div>
        </div>

        <!-- é‡‘é¡æ˜ç´°ï¼ˆç„¡é‹è²»ï¼‰-->
        <div class="summary-row">
          <span>å°è¨ˆ</span>
          <span id="cartSubtotal">$0</span>
        </div>

        <div class="summary-divider"></div>

        <!-- ç¸½è¨ˆ -->
        <div class="summary-total">
          <span class="summary-total-label">ç¸½è¨ˆ</span>
          <span class="summary-total-amount" id="cartTotal">$0</span>
        </div>

        <!-- çµå¸³æŒ‰éˆ• -->
        <button onclick="window.checkout()" class="checkout-btn">
          <span style="position: relative; z-index: 1;">ğŸ›’ ç¢ºèªçµå¸³</span>
        </button>

        <a href="menu.html" class="continue-shopping">
          â† ç¹¼çºŒé¸è³¼
        </a>
      </div>
    </div>
  </div>

  <!-- æ‰‹æ©Ÿç‰ˆå›ºå®šåº•éƒ¨çµå¸³æŒ‰éˆ•ï¼ˆä¿ç•™æ­¤å€å¡Šï¼‰-->
  <div id="mobileCheckoutFooter" class="mobile-checkout-footer" style="display: none;">
    <div class="mobile-checkout-content">
      <div class="mobile-total">
        <div class="mobile-total-label">ç¸½è¨ˆé‡‘é¡</div>
        <div class="mobile-total-amount" id="mobileCartTotal">$0</div>
      </div>
      <button onclick="window.checkout()" class="mobile-checkout-btn">
        çµå¸³ â†’
      </button>
    </div>
  </div>

  <!-- é å°¾ï¼ˆç°¡åŒ–ç¾åŒ–ç‰ˆï¼Œèˆ‡ index.html ä¸€è‡´ï¼‰-->
  <footer class="footer">
    <div class="footer-container">
      <!-- å“ç‰Œ/é—œæ–¼ -->
      <div class="footer-brand">
        <h3>â˜€ï¸ æ™¨å…‰æ—©é¤åº—</h3>
        <p>é–‹å•Ÿç¾å¥½çš„ä¸€å¤©ï¼Œå¾ç¾å‘³æ—©é¤é–‹å§‹ã€‚æˆ‘å€‘å …æŒä½¿ç”¨æ–°é®®é£Ÿæï¼Œç‚ºæ‚¨æä¾›å¥åº·ç‡Ÿé¤Šçš„æ—©é¤é¸æ“‡ã€‚</p>
      </div>
      
      <!-- è¯çµ¡è³‡è¨Š -->
      <div class="footer-contact">
        <h3>è¯çµ¡æˆ‘å€‘</h3>
        <ul class="footer-contact-list">
          <li>ğŸ“ é›»è©±ï¼š(04) 1234-5678</li>
          <li>ğŸ“ åœ°å€ï¼šå°ä¸­å¸‚è¥¿å€ç¾æ‘è·¯ä¸€æ®µ123è™Ÿ</li>
          <li>ğŸ•’ ç‡Ÿæ¥­æ™‚é–“ï¼š06:00 - 13:00</li>
          <li>ğŸ“§ Emailï¼šinfo@morning-glory.com</li>
        </ul>
      </div>
      
      <!-- ç¤¾ç¾¤/ç‰ˆæ¬Š -->
      <div class="footer-social-section">
        <h3>è¿½è¹¤æˆ‘å€‘</h3>
        <div class="footer-social">
          <a href="#" aria-label="Facebook" title="Facebook">ğŸ“˜</a>
          <a href="#" aria-label="Instagram" title="Instagram">ğŸ“·</a>
          <a href="#" aria-label="Line" title="Line">ğŸ’š</a>
        </div>
      </div>
    </div>
    
    <div class="footer-bottom">
      <p>&copy; 2024 æ™¨å…‰æ—©é¤åº— Morning Glory Breakfast. All rights reserved.</p>
    </div>
  </footer>

  <!-- åˆå§‹åŒ–è³¼ç‰©è»Šé é¢ -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      console.log('ğŸ“„ è³¼ç‰©è»Šé é¢è¼‰å…¥å®Œæˆ');
      
      // æ›´æ–°å°è¦½åˆ—ç”¨æˆ¶é¡¯ç¤º
      if (typeof window.updateNavbarUser === 'function') {
        window.updateNavbarUser();
      }
      
      // æ¸²æŸ“è³¼ç‰©è»Šé …ç›®
      if (typeof window.renderCartItems === 'function') {
        window.renderCartItems();
      } else {
        console.error('âŒ renderCartItems å‡½æ•¸æœªå®šç¾©');
      }
      
      // è¼‰å…¥å¯ç”¨æŠ˜åƒ¹åˆ¸
      if (typeof window.loadAvailableCoupons === 'function') {
        window.loadAvailableCoupons();
      } else {
        console.warn('âš ï¸ loadAvailableCoupons å‡½æ•¸æœªå®šç¾©');
      }
      
      // æ›´æ–°æ‰‹æ©Ÿç‰ˆåº•éƒ¨ç¸½é‡‘é¡
      window.updateMobileTotal = function() {
        const total = document.getElementById('cartTotal')?.textContent || '$0';
        const mobileTotal = document.getElementById('mobileCartTotal');
        if (mobileTotal) {
          mobileTotal.textContent = total;
        }
      };
    });
  </script>
  
  <style>
    /* ä»˜æ¬¾æ–¹å¼é¸æ“‡å€å¡Šæ¨£å¼ */
    .payment-section {
      margin-bottom: 1.5rem;
      padding-bottom: 1.5rem;
      border-bottom: 2px solid #f0f0f0;
    }
    
    .payment-label {
      display: block;
      font-weight: 600;
      color: #333;
      margin-bottom: 0.8rem;
      font-size: 1.05rem;
    }
    
    .payment-methods {
      display: flex;
      flex-direction: column;
      gap: 0.8rem;
    }
    
    .payment-option {
      display: flex;
      align-items: center;
      gap: 0.8rem;
      padding: 1rem;
      border: 2px solid #e0e0e0;
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    .payment-option:hover {
      border-color: #FF6B35;
      background: #FFF9F0;
    }
    
    .payment-option input[type="radio"] {
      width: 20px;
      height: 20px;
      cursor: pointer;
      accent-color: #FF6B35;
    }
    
    .payment-option input[type="radio"]:checked + .payment-icon {
      transform: scale(1.2);
    }
    
    .payment-option:has(input:checked) {
      border-color: #FF6B35;
      background: linear-gradient(135deg, #FFF3E0, #FFFFFF);
      box-shadow: 0 2px 8px rgba(255, 107, 53, 0.15);
    }
    
    .payment-icon {
      font-size: 1.5rem;
      transition: transform 0.2s ease;
    }
    
    .payment-text {
      flex: 1;
      font-weight: 600;
      color: #333;
      font-size: 1rem;
    }
    
    @media (max-width: 768px) {
      .payment-option {
        padding: 0.8rem;
      }
      
      .payment-icon {
        font-size: 1.3rem;
      }
      
      .payment-text {
        font-size: 0.95rem;
      }
    }
  </style>
</body>
</html>