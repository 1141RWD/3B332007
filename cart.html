<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>è³¼ç‰©è»Š - æ™¨å…‰æ—©é¤åº—</title>
  
  <!-- æ¨£å¼è¡¨ -->
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="css/cart.css">
  
  <!-- JavaScript æª”æ¡ˆ -->
  <script src="js/data.js"></script>
  <script src="js/utils.js"></script>
  <script src="js/coupon-system.js"></script>
  <script src="js/auth.js"></script>
  <script src="js/shop.js"></script>
  <script src="js/cart.js"></script>
</head>
<body class="cart-page">
  <!-- å°è¦½åˆ—ï¼ˆèˆ‡ index.html å®Œå…¨ä¸€è‡´ï¼‰-->
  <nav class="navbar" id="navbar">
    <div class="navbar-container">
      <a href="index.html" class="navbar-logo">
        <div class="logo-icon">ğŸŒ…</div>
        <div class="logo-text">
          <div class="logo-title">æ™¨å…‰æ—©é¤åº—</div>
          <div class="logo-subtitle">MORNING GLORY</div>
        </div>
      </a>
      
      <button class="navbar-toggle" id="navbarToggle" aria-label="é–‹å•Ÿé¸å–®">
        <span></span>
        <span></span>
        <span></span>
      </button>
      
      <ul class="navbar-menu" id="navbarMenu">
        <li><a href="index.html" class="navbar-link">ğŸ  é¦–é </a></li>
        <li><a href="menu.html" class="navbar-link">ğŸ³ ç·šä¸Šé»é¤</a></li>
        <li><div id="loginBtn" class="navbar-link"><a href="login.html">ğŸ” ç™»å…¥ / è¨»å†Š</a></div></li>
        <li>
          <a href="cart.html" class="navbar-link cart-link active">
            ğŸ›’ è³¼ç‰©è»Š
            <span class="cart-badge" id="cartBadge">0</span>
          </a>
        </li>
      </ul>
    </div>
  </nav>
  
  <!-- å°è¦½åˆ—åŠŸèƒ½è…³æœ¬ -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // å°è¦½åˆ—åˆ‡æ›åŠŸèƒ½
      const navbarToggle = document.getElementById('navbarToggle');
      const navbarMenu = document.getElementById('navbarMenu');
      
      if (navbarToggle && navbarMenu) {
        navbarToggle.addEventListener('click', () => {
          navbarToggle.classList.toggle('active');
          navbarMenu.classList.toggle('active');
        });
        
        const navbarLinks = document.querySelectorAll('.navbar-link');
        navbarLinks.forEach(link => {
          link.addEventListener('click', () => {
            if (window.innerWidth <= 768) {
              navbarToggle.classList.remove('active');
              navbarMenu.classList.remove('active');
            }
          });
        });
      }
      
      // æ›´æ–°è³¼ç‰©è»Šå¾½ç« 
      const updateCartBadge = () => {
        const cart = JSON.parse(localStorage.getItem('cart') || '[]');
        const cartBadge = document.getElementById('cartBadge');
        
        if (cartBadge) {
          const totalItems = cart.reduce((sum, item) => sum + (item.quantity || 1), 0);
          cartBadge.textContent = totalItems;
          cartBadge.style.display = totalItems > 0 ? 'flex' : 'none';
        }
      };
      
      updateCartBadge();
    });
  </script>

  <!-- è³¼ç‰©è»Šä¸»è¦å…§å®¹ -->
  <div class="cart-container">
    <!-- è³¼ç‰©è»Šæ¨™é¡Œ -->
    <div class="cart-header">
      <h1>ğŸ›’ æˆ‘çš„è³¼ç‰©è»Š</h1>
      <p>æª¢æŸ¥æ‚¨çš„ç¾å‘³é¸æ“‡</p>
    </div>

    <!-- è³¼ç‰©è»Šå…§å®¹ï¼ˆå·¦å³å…©æ¬„å¼è¨­è¨ˆï¼‰-->
    <div class="cart-content">
      <!-- å·¦å´ï¼šå•†å“åˆ—è¡¨ï¼ˆä½” 70%ï¼‰-->
      <div class="cart-items-section">
        <div class="cart-items-header">
          <span id="cartItemsCount">æ‚¨çš„é¤é»</span>
        </div>

        <!-- ç©ºè³¼ç‰©è»Šç‹€æ…‹ï¼ˆå„ªåŒ–ç‰ˆï¼‰-->
        <div id="emptyCart" class="empty-cart" style="display: none;">
          <div class="empty-cart-icon">ğŸ›’</div>
          <h2>è³¼ç‰©è»Šç›®å‰æ˜¯ç©ºçš„ï¼Œè‚šå­é¤“äº†å—ï¼Ÿ</h2>
          <p style="color: var(--dark-gray); margin-bottom: 2rem; font-size: 1.1rem;">
            å¿«ä¾†æŒ‘é¸ç¾å‘³çš„æ—©é¤ï¼Œé–‹å•Ÿç¾å¥½çš„ä¸€å¤©ï¼<br>
            æˆ‘å€‘æœ‰å„å¼å„æ¨£çš„è›‹é¤…ã€æ¼¢å ¡ã€åå¸å’Œé£²æ–™ç­‰è‘—æ‚¨ï½
          </p>
          <a href="menu.html" class="go-shopping-btn">ğŸ³ å‰å¾€é»é¤</a>
        </div>

        <!-- è³¼ç‰©è»Šå•†å“åˆ—è¡¨ï¼ˆç”± JavaScript å‹•æ…‹ç”Ÿæˆï¼‰-->
        <div id="cartItems"></div>
      </div>

      <!-- å³å´ï¼šè¨‚å–®æ‘˜è¦å¡ç‰‡ï¼ˆä½” 30%ï¼‰-->
      <div id="cartSummary" class="cart-summary" style="display: none;">
        <h2 class="summary-title">ğŸ’° è¨‚å–®æ‘˜è¦</h2>

        <!-- æŠ˜åƒ¹åˆ¸é¸æ“‡ -->
        <div class="coupon-section">
          <label for="couponSelect" class="coupon-label">ğŸ« ä½¿ç”¨æŠ˜åƒ¹åˆ¸</label>
          <select id="couponSelect" class="coupon-select" onchange="window.calculateTotal()">
            <option value="">è¼‰å…¥ä¸­...</option>
          </select>
        </div>

        <!-- æŠ˜æ‰£è³‡è¨Šï¼ˆä½¿ç”¨æŠ˜åƒ¹åˆ¸æ™‚é¡¯ç¤ºï¼‰-->
        <div id="discountInfo" class="discount-info" style="display: none;">
          <div class="discount-row">
            <span>åŸåƒ¹</span>
            <span id="originalPrice">$0</span>
          </div>
          <div class="discount-row total">
            <span>ğŸ’° æŠ˜æ‰£å„ªæƒ </span>
            <span id="discountAmount">-$0</span>
          </div>
        </div>

        <!-- é‡‘é¡æ˜ç´° -->
        <div class="summary-row">
          <span>å°è¨ˆ</span>
          <span id="cartSubtotal">$0</span>
        </div>

        <div class="summary-divider"></div>

        <!-- ç¸½è¨ˆ -->
        <div class="summary-total">
          <span class="summary-total-label">ç¸½è¨ˆ</span>
          <span class="summary-total-amount" id="cartTotal">$0</span>
        </div>

        <!-- çµå¸³æŒ‰éˆ• -->
        <button onclick="window.goToCheckout()" class="checkout-btn" id="checkoutButton">
          <span style="position: relative; z-index: 1;">ğŸ›’ å‰å¾€çµå¸³</span>
        </button>

        <a href="menu.html" class="continue-shopping">
          â† ç¹¼çºŒé¸è³¼
        </a>
      </div>
    </div>
  </div>

  <!-- æ‰‹æ©Ÿç‰ˆå›ºå®šåº•éƒ¨çµå¸³æŒ‰éˆ•å·²ç§»é™¤ï¼ˆé¿å…é®æ“‹å…§å®¹ï¼‰-->

  <!-- é å°¾ï¼ˆç°¡åŒ–ç¾åŒ–ç‰ˆï¼Œèˆ‡ index.html ä¸€è‡´ï¼‰-->
  <footer class="footer">
    <div class="footer-container">
      <!-- å“ç‰Œ/é—œæ–¼ -->
      <div class="footer-brand">
        <h3>â˜€ï¸ æ™¨å…‰æ—©é¤åº—</h3>
        <p>é–‹å•Ÿç¾å¥½çš„ä¸€å¤©ï¼Œå¾ç¾å‘³æ—©é¤é–‹å§‹ã€‚æˆ‘å€‘å …æŒä½¿ç”¨æ–°é®®é£Ÿæï¼Œç‚ºæ‚¨æä¾›å¥åº·ç‡Ÿé¤Šçš„æ—©é¤é¸æ“‡ã€‚</p>
      </div>
      
      <!-- è¯çµ¡è³‡è¨Š -->
      <div class="footer-contact">
        <h3>è¯çµ¡æˆ‘å€‘</h3>
        <ul class="footer-contact-list">
          <li>ğŸ“ é›»è©±ï¼š(04) 1234-5678</li>
          <li>ğŸ“ åœ°å€ï¼šå°ä¸­å¸‚è¥¿å€ç¾æ‘è·¯ä¸€æ®µ123è™Ÿ</li>
          <li>ğŸ•’ ç‡Ÿæ¥­æ™‚é–“ï¼š06:00 - 13:00</li>
          <li>ğŸ“§ Emailï¼šinfo@morning-glory.com</li>
        </ul>
      </div>
      
      <!-- ç¤¾ç¾¤/ç‰ˆæ¬Š -->
      <div class="footer-social-section">
        <h3>è¿½è¹¤æˆ‘å€‘</h3>
        <div class="footer-social">
          <a href="#" aria-label="Facebook" title="Facebook">ğŸ“˜</a>
          <a href="#" aria-label="Instagram" title="Instagram">ğŸ“·</a>
          <a href="#" aria-label="Line" title="Line">ğŸ’š</a>
        </div>
      </div>
    </div>
    
    <div class="footer-bottom">
      <p>&copy; 2024 æ™¨å…‰æ—©é¤åº— Morning Glory Breakfast. All rights reserved.</p>
    </div>
  </footer>

  <!-- ç·¨è¼¯å•†å“ Modal -->
  <div id="editItemModal" class="edit-modal" style="display: none;">
    <div class="edit-modal-overlay" onclick="window.closeEditModal()"></div>
    <div class="edit-modal-content">
      <div class="edit-modal-header">
        <h2 class="edit-modal-title">âœï¸ ç·¨è¼¯å•†å“</h2>
        <button class="edit-modal-close" onclick="window.closeEditModal()">&times;</button>
      </div>
      <div class="edit-modal-body" id="editModalBody">
        <!-- å‹•æ…‹ç”Ÿæˆç·¨è¼¯è¡¨å–® -->
      </div>
      <div class="edit-modal-footer">
        <button class="edit-modal-btn-cancel" onclick="window.closeEditModal()">å–æ¶ˆ</button>
        <button class="edit-modal-btn-save" onclick="window.saveEditItem()">ğŸ’¾ å„²å­˜è®Šæ›´</button>
      </div>
    </div>
  </div>

  <!-- åˆå§‹åŒ–è³¼ç‰©è»Šé é¢ -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      console.log('ğŸ“„ è³¼ç‰©è»Šé é¢è¼‰å…¥å®Œæˆ');
      
      // æ›´æ–°å°è¦½åˆ—ç”¨æˆ¶é¡¯ç¤º
      if (typeof window.updateNavbarUser === 'function') {
        window.updateNavbarUser();
      }
      
      // æ¸²æŸ“è³¼ç‰©è»Šé …ç›®
      if (typeof window.renderCartItems === 'function') {
        window.renderCartItems();
      } else {
        console.error('âŒ renderCartItems å‡½æ•¸æœªå®šç¾©');
      }
      
      // è¼‰å…¥å¯ç”¨æŠ˜åƒ¹åˆ¸
      if (typeof window.loadAvailableCoupons === 'function') {
        window.loadAvailableCoupons();
      } else {
        console.warn('âš ï¸ loadAvailableCoupons å‡½æ•¸æœªå®šç¾©');
      }
      
      // æ›´æ–°æ‰‹æ©Ÿç‰ˆåº•éƒ¨ç¸½é‡‘é¡
      window.updateMobileTotal = function() {
        const total = document.getElementById('cartTotal')?.textContent || '$0';
        const mobileTotal = document.getElementById('mobileCartTotal');
        if (mobileTotal) {
          mobileTotal.textContent = total;
        }
      };
    });
  </script>
  
  <style>
    /* ä»˜æ¬¾æ–¹å¼é¸æ“‡å€å¡Šæ¨£å¼ */
    .payment-section {
      margin-bottom: 1.5rem;
      padding-bottom: 1.5rem;
      border-bottom: 2px solid #f0f0f0;
    }
    
    .payment-label {
      display: block;
      font-weight: 600;
      color: #333;
      margin-bottom: 0.8rem;
      font-size: 1.05rem;
    }
    
    .payment-methods {
      display: flex;
      flex-direction: column;
      gap: 0.8rem;
    }
    
    .payment-option {
      display: flex;
      align-items: center;
      gap: 0.8rem;
      padding: 1rem;
      border: 2px solid #e0e0e0;
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    .payment-option:hover {
      border-color: #FF6B35;
      background: #FFF9F0;
    }
    
    .payment-option input[type="radio"] {
      width: 20px;
      height: 20px;
      cursor: pointer;
      accent-color: #FF6B35;
    }
    
    .payment-option input[type="radio"]:checked + .payment-icon {
      transform: scale(1.2);
    }
    
    .payment-option:has(input:checked) {
      border-color: #FF6B35;
      background: linear-gradient(135deg, #FFF3E0, #FFFFFF);
      box-shadow: 0 2px 8px rgba(255, 107, 53, 0.15);
    }
    
    .payment-icon {
      font-size: 1.5rem;
      transition: transform 0.2s ease;
    }
    
    .payment-text {
      flex: 1;
      font-weight: 600;
      color: #333;
      font-size: 1rem;
    }
    
    @media (max-width: 768px) {
      .payment-option {
        padding: 0.8rem;
      }
      
      .payment-icon {
        font-size: 1.3rem;
      }
      
      .payment-text {
        font-size: 0.95rem;
      }
    }
  </style>
</body>
</html>